public class Base {
    
    public AndroidDriver driver;
    public AppiumDriverLocalService service;
    static String PermissionControllerPackage = "com.google.android.permissioncontroller";
    static String PermissionControllerActivity = "com.android.permissioncontroller.permission.ui.ReviewPermissionsActivity";
    @Test
    public void configureAppium() throws MalformedURLException, UnknownHostException, InterruptedException {
        //capture local host
        //InetAddress ip = InetAddress.getLocalHost();
        
        //run appium server automatically
         service = new AppiumServiceBuilder().withAppiumJS(new File("C:\\Users\\RMISHRA\\AppData\\Roaming\\npm\\node_modules\\appium\\build\\lib\\main.js"))
         //.withIPAddress(ip.getHostAddress()).usingPort(4723).build();
        .withIPAddress("127.0.0.1").usingPort(4723).build();
        //start appium server
         service.start();
         
        // create capabilities
        UiAutomator2Options options = new UiAutomator2Options();
        options.setCapability("platformName", "ANDROID");
        options.setCapability("automationName", "UIAutomator2");
        options.setCapability("autoGrantPermissions", true);
        //options.setCapability("autoAcceptAlerts", true);
        //options.setCapability("autoDismissAlerts", true);
        //options.setCapability("appWaitActivity","com.android.permissioncontroller.permission.ui.ReviewPermissionsActivity");
        //options.setCapability(AndroidMobileCapabilityType.APP_WAIT_ACTIVITY, "com.google.android.permissioncontroller.*");
        //options.setCapability("appActivity", ".ui.activity.IntroSlideShowActivity");
//      HashMap<String, Object> browserstackOptions = new HashMap<String, Object>();
//      browserstackOptions.put("autoAcceptAlerts", "true"); //to accept all alerts
        //options.setAppPackage(PermissionControllerPackage);
        //options.setAppActivity(PermissionControllerActivity);
        //options.setCapability("appPackage", "io.appium.android.apis"); 
       // options.setCapability("appActivity","io.appium.android.apis.ApiDemos");
//      options.setCapability("fullReset", false);
        //options.setCapability("app",System.getProperty("user.dir") + "\\src\\test\\java\\resources\\com.android.calculator2.apk");
        options.setCapability("app",System.getProperty("user.dir") + "\\src\\test\\java\\resources\\demo.apk");
        //options.setCapability("app",System.getProperty("user.dir") + "\\src\\test\\java\\resources\\ApiDemos-debug.apk");
        //options.setCapability("app",System.getProperty("user.dir") + "\\src\\test\\java\\APKPure_v3.19.3601_apkpure.com.apk");
        
        // create object for Android driver
        //driver = new AndroidDriver(new URL("http://"+ip.getHostAddress()+":4723"), options);
        driver = new AndroidDriver(new URL("http://127.0.0.1:4723"), options);
        driver.manage().timeouts().implicitlyWait(Duration.ofSeconds(30));
        
        
        //WebElement alerts = driver.findElement(By.id("android:id/button1"));
        //wait.until(((Object) alerts).alertIsPresent());
        Alert alert = driver.switchTo().alert();
        alert.accept();
        //driver.findElement(By.xpath(".//android.widget.Button[@text='Allow']")).click();
        //driver.findElement(AppiumBy.accessibilityId("Preference"));
        
        
        /** Object locators: xpath, id, className, accessibilityId, androidUIautomator
         appiumby is only used with accessibilityId and androidUIautomator **/
        
        //driver.findElement(AppiumBy.accessibilityId("Messages"));
        driver.findElement(By.id("com.dgotlieb.automationsample:id/userName")).sendKeys("admin");
        driver.findElement(By.id("com.dgotlieb.automationsample:id/userPassword")).sendKeys("admin");
        driver.findElement(By.id("com.dgotlieb.automationsample:id/loginButton")).click();
        WebElement ErrorMessage = driver.findElement(By.id("com.dgotlieb.automationsample:id/errorTV"));
        String Text = ErrorMessage.getText();
        System.out.println("Captured text is : "+ErrorMessage.getText());
        Assert.assertEquals(ErrorMessage.getText(), "Wrong username or password"); 
        //driver.wait(10000);
        driver.quit();
        
        //stop appium server
        //service.stop();
    }
    
}
